(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     54422,       1538]
NotebookOptionsPosition[     51628,       1453]
NotebookOutlinePosition[     52159,       1474]
CellTagsIndexPosition[     52116,       1471]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Costa\[CloseCurlyQuote]s Minimal Surface with Minimal Fuss\
\>", "Title",
 CellChangeTimes->{{3.595791378083267*^9, 3.595791387845916*^9}}],

Cell["Andrej Bauer", "Subtitle",
 CellChangeTimes->{{3.595791390542944*^9, 3.595791391881361*^9}}],

Cell["\<\
Dedicated to all students who have never gone the extra mile.\
\>", "Subsubtitle",
 CellChangeTimes->{{3.595791396926875*^9, 3.5957914357994204`*^9}, {
  3.5965673377533073`*^9, 3.596567346727313*^9}},
 FontSlant->"Italic"],

Cell[CellGroupData[{

Cell["Costa\[CloseCurlyQuote]s surface", "Section",
 CellChangeTimes->{{3.59579245810077*^9, 3.595792461049549*^9}, {
  3.596567380300736*^9, 3.5965673828187227`*^9}}],

Cell[TextData[{
 ButtonBox["Costa\[CloseCurlyQuote]s minimal surface",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://mathworld.wolfram.com/CostaMinimalSurface.html"], None},
  ButtonNote->"http://mathworld.wolfram.com/CostaMinimalSurface.html"],
 " is a surface with some amazing mathematical properties which we are not \
going to discuss here. We are only concerned with how to draw it. Recall that \
a surface ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", " ", "\[Subset]", " ", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "3"]}], TraditionalForm]]],
 " can be represented by a map ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", " ", "\[CapitalOmega]"}], " ", "\[Rule]", " ", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "3"]}], TraditionalForm]]],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalOmega]", " ", "\[Subset]", " ", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "2"]}], TraditionalForm]]],
 ". For each point ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", ",", "y"}], ")"}], " ", "\[Element]", " ", 
    "\[CapitalOmega]"}], TraditionalForm]]],
 " we get a point ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{"x", ",", "y"}], ")"}], " ", "\[Element]", " ", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "3"]}], TraditionalForm]]],
 ". As ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"x", ",", "y"}], ")"}], TraditionalForm]]],
 " ranges over ",
 Cell[BoxData[
  FormBox["\[CapitalOmega]", TraditionalForm]]],
 ", the values ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"x", ",", "y"}], ")"}], TraditionalForm]]],
 " range over ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.59579144639122*^9, 3.595791757512073*^9}, 
   3.595791807069127*^9, {3.595791937906891*^9, 3.5957919465670767`*^9}, {
   3.596567404935521*^9, 3.596567404941963*^9}}],

Cell[TextData[{
 "Costa\[CloseCurlyQuote]s surface is parametrized by the function ",
 StyleBox["costa", "Input"],
 " defined below. The region ",
 Cell[BoxData[
  FormBox["\[CapitalOmega]", TraditionalForm]]],
 " is the square ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}], "\[Cross]", 
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}]}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.595791813261945*^9, 3.59579183159827*^9}, {
  3.596567518297884*^9, 3.596567521828651*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"g", ",", "e", ",", "costa"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"WeierstrassInvariants", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{"I", "/", "2"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", " ", "=", " ", 
    RowBox[{"WeierstrassP", "[", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", "g"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"costa", "::", "usage"}], "=", 
    "\"\<Compute a point on the Costa's minimal surface.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costa", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wz1", "=", 
       RowBox[{"WeierstrassZeta", "[", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"I", " ", "y"}]}], ",", "g"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wz23", "=", 
       RowBox[{
        RowBox[{"WeierstrassZeta", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}], "-", 
           RowBox[{"1", "/", "2"}]}], ",", "g"}], "]"}], "-", 
        RowBox[{"WeierstrassZeta", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}], "-", 
           RowBox[{"I", "/", "2"}]}], ",", "g"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wp", "=", 
       RowBox[{"WeierstrassP", "[", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"I", " ", "y"}]}], ",", "g"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pi", " ", "x"}], "+", 
         RowBox[{
          RowBox[{"Pi", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", 
            RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "-", 
         RowBox[{"Re", "[", "wz1", "]"}], "+", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "*", 
          RowBox[{"Re", "[", "wz23", "]"}]}]}], ")"}], "/", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pi", " ", "y"}], "+", 
         RowBox[{
          RowBox[{"Pi", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", 
            RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "+", 
         RowBox[{"Im", "[", "wz1", "]"}], "+", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "*", 
          RowBox[{"Im", "[", "wz23", "]"}]}]}], ")"}], "/", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"2", "Pi"}], "]"}], "/", "4"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"wp", "-", "e"}], "]"}], "]"}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"wp", "+", "e"}], "]"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.595791832670101*^9, 3.595791907498267*^9}, {
   3.5957919525811787`*^9, 3.595792079595923*^9}, {3.595923295274453*^9, 
   3.595923456964209*^9}, {3.595923493316042*^9, 3.595923545127228*^9}, {
   3.595923615033736*^9, 3.5959236354598417`*^9}, 3.595923696421731*^9, {
   3.595923727649817*^9, 3.5959237497532997`*^9}, {3.5959238288122787`*^9, 
   3.595923864129364*^9}, {3.5959239026991796`*^9, 3.5959239617408867`*^9}, {
   3.595948778034437*^9, 3.5959488031976023`*^9}, {3.595949632412149*^9, 
   3.595949669019676*^9}, {3.596567497705854*^9, 3.596567544983901*^9}}],

Cell["This already suffices for a nice picture of the surface:", "Text",
 CellChangeTimes->{{3.5957922428441257`*^9, 3.5957922503832893`*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"costa", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.59579218476819*^9, 3.5957921965136414`*^9}, {
   3.59599437792848*^9, 3.595994380983287*^9}, {3.596424788910643*^9, 
   3.5964247937471457`*^9}, {3.59642482578277*^9, 3.5964248265751047`*^9}, {
   3.596424899758688*^9, 3.5964249003101873`*^9}, {3.5964264793095417`*^9, 
   3.596426483935275*^9}, {3.596426537380992*^9, 3.5964265437574863`*^9}, {
   3.596427491503303*^9, 3.5964274923325157`*^9}, 3.596566858699957*^9, {
   3.596567550691669*^9, 3.596567558386506*^9}}],

Cell[TextData[{
 "It is instructive to plot the magnitude of ",
 StyleBox["costa[x,y]", "Input"],
 ":"
}], "Text",
 CellChangeTimes->{{3.595792359904025*^9, 3.5957923854178343`*^9}}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{"costa", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5957922958708267`*^9, 3.5957923158239594`*^9}, {
  3.5957924351632442`*^9, 3.595792437949576*^9}}],

Cell["\<\
As you can see, there are poles at the corners of the unit square, as well as \
the midpoints of the sides. Because of these, the surface streches out to \
infinity. We should be careful about how we draw things near the poles.\
\>", "Text",
 CellChangeTimes->{{3.59579248608374*^9, 3.595792497771015*^9}, {
  3.595792554656645*^9, 3.595792589594449*^9}, {3.5957926427162943`*^9, 
  3.5957926981043577`*^9}, {3.5965676291268787`*^9, 3.596567661756487*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing the normals to the surface\
\>", "Section",
 CellChangeTimes->{{3.595792720039558*^9, 3.595792724715693*^9}}],

Cell[TextData[{
 "If you want to draw Costa\[CloseCurlyQuote]s surface with a raytracer such \
as PovRay, you may wish to compute the normals to the surface. So let us do \
that as well. Recall that the normal at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "[", 
    RowBox[{
     SubscriptBox["x", "0"], ",", 
     SubscriptBox["y", "0"]}], "]"}], TraditionalForm]]],
 " to a surface parametrized by a map ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]]],
 " is the vector product ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "x"], "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["y", "0"]}], "]"}], " ", "\[Cross]", " ", 
    RowBox[{
     SubscriptBox["f", "y"], "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["y", "0"]}], "]"}]}], TraditionalForm]]],
 " where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "x"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "y"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are the partial derivatives of ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],
  FormatType->"TraditionalForm"],
 ". The partial derivatives of ",
 StyleBox["costa", "Input"],
 " are beyond ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s abilities, so we need to tell it how to compute them."
}], "Text",
 CellChangeTimes->{{3.595792726114058*^9, 3.595792964518983*^9}, {
  3.595948438813192*^9, 3.595948462595937*^9}, {3.596567680577381*^9, 
  3.596567887103443*^9}}],

Cell[TextData[{
 "The first two components of ",
 StyleBox["costa[x,y]", "Input"],
 " are real parts of holomorphic functions. For these, the partial derivative \
and the real part ",
 StyleBox["Re", "Input"],
 " commute. The third component must be computed by hand because it is not \
holomorphic. It gets tricky to get the derivatives right (at least for me), \
so we\[CloseCurlyQuote]re going to double-check them by numerical integration."
}], "Text",
 CellChangeTimes->{
  3.595792829417706*^9, {3.5957929702342157`*^9, 3.5957930071654863`*^9}, {
   3.596345257840873*^9, 3.596345282519781*^9}, {3.596567898139933*^9, 
   3.5965679136885643`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "checkDerivative", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkDerivative", "::", "usage"}], "=", 
   "\"\<Check that g is the derivative of f by integarting from x0 to \
x1.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkDerivative", "[", 
   RowBox[{"f_", ",", "g_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "x1_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", "/.", 
       RowBox[{"x", "->", "x1"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"f", "/.", 
       RowBox[{"x", "\[Rule]", "x0"}]}], ")"}]}], "]"}], "-", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"N", "[", "g", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "x0", ",", " ", "x1"}], "}"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.596344847142147*^9, 3.596344911564391*^9}, {
  3.596344958691833*^9, 3.5963449640017653`*^9}, {3.5963449999421587`*^9, 
  3.596345066206064*^9}, {3.5963452903822117`*^9, 3.596345290847674*^9}, {
  3.596345377756878*^9, 3.596345380257039*^9}, {3.596567924776333*^9, 
  3.596567951749353*^9}}],

Cell[TextData[{
 "We need the partial derivatives of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}], "\[RightTeeArrow]", "log"}], "|", 
    RowBox[{"f", "(", 
     RowBox[{"x", "+", 
      RowBox[{"\[DoubleStruckI]", " ", "y"}]}], ")"}], "|"}], 
   TraditionalForm]]],
 " where ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]]],
 " is holomorphic. This requires a bit of work. First we have the partial \
derivatives of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "+", "\[DoubleStruckI]y"}], ")"}], "\[RightTeeArrow]", 
     "log"}], "|", 
    RowBox[{"x", "+", 
     RowBox[{"\[DoubleStruckI]", " ", "y"}]}], "|"}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.596348832121332*^9, 3.596349035003378*^9}, {
  3.5965679610549507`*^9, 3.596567974917157*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"logAbsDX", ",", "logAbsDY"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logAbsDX", "[", "z_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Re", "[", "z", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Re", "[", "z", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"Im", "[", "z", "]"}], "2"]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logAbsDY", "[", "z_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Im", "[", "z", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Re", "[", "z", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"Im", "[", "z", "]"}], "2"]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.5959488487025337`*^9, 3.595948945324094*^9}, {
  3.595948991615432*^9, 3.5959489942299337`*^9}, {3.5959494446982718`*^9, 
  3.595949577154052*^9}}],

Cell[TextData[{
 "Then there will be the chain rule which allows us to compute the \
derivatives of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}], "\[RightTeeArrow]", "log"}], "|", 
    RowBox[{"f", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"\[DoubleStruckI]", " ", "y"}]}], ")"}]}], "|"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", given ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and its derivative ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "'"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.5963490075891113`*^9, 3.596349057628386*^9}, {
  3.596349137862776*^9, 3.596349151450865*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"logAbsChainX", ",", " ", "logAbsChainY"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logAbsChainX", "[", 
   RowBox[{"f_", ",", "fPrime_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"logAbsDX", "[", "f", "]"}], "*", 
    RowBox[{"Re", "[", "fPrime", "]"}]}], "+", 
   RowBox[{
    RowBox[{"logAbsDY", "[", "f", "]"}], "*", 
    RowBox[{"Im", "[", "fPrime", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"logAbsChainY", "[", 
   RowBox[{"f_", ",", "fPrime_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"logAbsDX", "[", "f", "]"}]}], "*", 
    RowBox[{"Im", "[", "fPrime", "]"}]}], "+", 
   RowBox[{
    RowBox[{"logAbsDY", "[", "f", "]"}], "*", 
    RowBox[{"Re", "[", "fPrime", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.596349059550231*^9, 3.596349190262721*^9}, {
  3.596349599741582*^9, 3.596349602202569*^9}, {3.596360356046089*^9, 
  3.596360367404119*^9}}],

Cell[TextData[{
 "The partial derivative of ",
 StyleBox["costa", "Input"],
 " with respect to ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.595793010055511*^9, 3.595793031091667*^9}, {
  3.5959490002754*^9, 3.595949002787764*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "costaX", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaX", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wz1D", "=", 
       RowBox[{"-", 
        RowBox[{"WeierstrassP", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", "*", "y"}]}], ",", "g"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wz23D", "=", 
       RowBox[{
        RowBox[{"WeierstrassP", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", "*", "y"}], "-", 
           RowBox[{"I", "/", "2"}]}], ",", "g"}], "]"}], "-", 
        RowBox[{"WeierstrassP", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", "*", "y"}], "-", 
           RowBox[{"1", "/", "2"}]}], ",", "g"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wp", "=", 
       RowBox[{"WeierstrassP", "[", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"I", "*", "y"}]}], ",", "g"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wpD", "=", 
       RowBox[{"WeierstrassPPrime", "[", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"I", "*", "y"}]}], ",", "g"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pi", " ", "-", 
         RowBox[{"Re", "[", "wz1D", "]"}], "+", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "*", 
          RowBox[{"Re", "[", "wz23D", "]"}]}]}], ")"}], "/", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Im", "[", "wz1D", "]"}], "+", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "*", 
          RowBox[{"Im", "[", "wz23D", "]"}]}]}], ")"}], "/", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"2", "Pi"}], "]"}], "/", "4"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"logAbsChainX", "[", 
          RowBox[{
           RowBox[{"wp", "-", "e"}], ",", "wpD"}], "]"}], "-", 
         RowBox[{"logAbsChainX", "[", 
          RowBox[{
           RowBox[{"wp", "+", "e"}], ",", "wpD"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.595793032239459*^9, 3.59579323335005*^9}, {
  3.595793301650461*^9, 3.5957933949920607`*^9}, {3.59592282579065*^9, 
  3.595922856005727*^9}, {3.595922886103503*^9, 3.595922933986908*^9}, {
  3.595923227818486*^9, 3.595923268654401*^9}, {3.595923991876843*^9, 
  3.595924060350788*^9}, {3.595948319517399*^9, 3.5959483501417437`*^9}, {
  3.595948385693667*^9, 3.5959484263614693`*^9}, {3.595948491360173*^9, 
  3.595948527584702*^9}, {3.5959490094560337`*^9, 3.5959490762310963`*^9}, {
  3.595949330560618*^9, 3.595949383225561*^9}, {3.595949610907255*^9, 
  3.595949617013084*^9}, {3.5959496816410522`*^9, 3.595949687282365*^9}, {
  3.596348306926669*^9, 3.59634831569775*^9}, {3.596360393058321*^9, 
  3.596360427518354*^9}}],

Cell["\<\
Did we get it right? If so, we should get a triple of zeroes:\
\>", "Text",
 CellChangeTimes->{{3.596345457737905*^9, 3.596345469028337*^9}, {
  3.596346302671616*^9, 3.596346310298757*^9}}],

Cell[BoxData[
 RowBox[{"checkDerivative", "[", 
  RowBox[{
   RowBox[{"costa", "[", 
    RowBox[{"x", ",", "0.2"}], "]"}], ",", 
   RowBox[{"costaX", "[", 
    RowBox[{"x", ",", "0.2"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0.2", ",", "0.7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.596345301068644*^9, 3.596345328912979*^9}, {
  3.596345360541574*^9, 3.5963453910057917`*^9}, {3.5963454450499277`*^9, 
  3.5963454509382067`*^9}, {3.596347028188108*^9, 3.596347030469809*^9}}],

Cell["Good enough.", "Text",
 CellChangeTimes->{{3.596346312802845*^9, 3.5963463149206657`*^9}}],

Cell[TextData[{
 "The partial derivative of ",
 StyleBox["costa", "Input"],
 " with respect to ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.595793010055511*^9, 3.595793031091667*^9}, {
  3.5959490002754*^9, 3.595949002787764*^9}, {3.595949406321231*^9, 
  3.595949406510166*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "costaY", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaY", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wz1D", "=", 
       RowBox[{"-", 
        RowBox[{"WeierstrassP", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", "*", "y"}]}], ",", "g"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wz23D", "=", 
       RowBox[{
        RowBox[{"WeierstrassP", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", "*", "y"}], "-", 
           RowBox[{"I", "/", "2"}]}], ",", "g"}], "]"}], "-", 
        RowBox[{"WeierstrassP", "[", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"I", "*", "y"}], "-", 
           RowBox[{"1", "/", "2"}]}], ",", "g"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wp", "=", 
       RowBox[{"WeierstrassP", "[", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"I", "*", "y"}]}], ",", "g"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"wpD", "=", 
       RowBox[{"WeierstrassPPrime", "[", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"I", "*", "y"}]}], ",", "g"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Im", "[", "wz1D", "]"}], "-", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "*", 
          RowBox[{"Im", "[", "wz23D", "]"}]}]}], ")"}], "/", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pi", " ", "+", 
         RowBox[{"Re", "[", "wz1D", "]"}], "+", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Re", "[", "e", "]"}]}], ")"}]}], "*", 
          RowBox[{"Re", "[", "wz23D", "]"}]}]}], ")"}], "/", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"2", "Pi"}], "]"}], "/", "4"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"logAbsChainY", "[", 
          RowBox[{
           RowBox[{"wp", "-", "e"}], ",", "wpD"}], "]"}], "-", 
         RowBox[{"logAbsChainY", "[", 
          RowBox[{
           RowBox[{"wp", "+", "e"}], ",", "wpD"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.595793032239459*^9, 3.59579323335005*^9}, {
   3.595793301650461*^9, 3.5957933949920607`*^9}, {3.59592282579065*^9, 
   3.595922856005727*^9}, {3.595922886103503*^9, 3.595922933986908*^9}, {
   3.595923227818486*^9, 3.595923268654401*^9}, {3.595923991876843*^9, 
   3.595924060350788*^9}, {3.595948319517399*^9, 3.5959483501417437`*^9}, {
   3.595948385693667*^9, 3.5959484263614693`*^9}, {3.595948491360173*^9, 
   3.595948527584702*^9}, {3.5959490094560337`*^9, 3.5959490762310963`*^9}, {
   3.595949330560618*^9, 3.595949409633381*^9}, {3.59594970952503*^9, 
   3.595949732783169*^9}, 3.595951384361875*^9, {3.595951474542569*^9, 
   3.595951496739161*^9}, {3.59595153736378*^9, 3.5959515437270412`*^9}, {
   3.5959515786818438`*^9, 3.595951612043648*^9}, {3.595993562706223*^9, 
   3.5959936048798857`*^9}, 3.59634701357167*^9, {3.5963648886093082`*^9, 
   3.596364911719776*^9}}],

Cell["\<\
And did we get this derivative right?\
\>", "Text",
 CellChangeTimes->{{3.596345479650792*^9, 3.596345487453783*^9}}],

Cell[BoxData[
 RowBox[{"checkDerivative", "[", 
  RowBox[{
   RowBox[{"costa", "[", 
    RowBox[{"0.2", ",", "y"}], "]"}], ",", 
   RowBox[{"costaY", "[", 
    RowBox[{"0.2", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0.2", ",", "0.7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.596345301068644*^9, 3.596345328912979*^9}, {
  3.596345360541574*^9, 3.5963453910057917`*^9}, {3.5963454450499277`*^9, 
  3.5963454509382067`*^9}, {3.596345490803832*^9, 3.5963455508493557`*^9}}],

Cell["\<\
Excellent, now we can compute normals to the surface:\
\>", "Text",
 CellChangeTimes->{{3.596364916770091*^9, 3.596364928609577*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "costaNormal", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"costaNormal", "::", "usage"}], "=", 
   "\"\<Compute the normal to Costa's surface at a given point.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaNormal", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Normalize", "[", 
   RowBox[{"N", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"costaX", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"costaY", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.595993674838097*^9, 3.5959936911917887`*^9}, {
  3.596568006768622*^9, 3.596568065058441*^9}}],

Cell["\<\
Here is a simple function that draws little arrows for normals.\
\>", "Text",
 CellChangeTimes->{{3.595993858213269*^9, 3.595993869648117*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "normalArrow", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalArrow", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"N", "[", 
        RowBox[{"costa", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"b", " ", "=", 
       RowBox[{"costaNormal", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"a", "+", "b"}]}], "}"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.595993872129974*^9, 3.5959939658388557`*^9}, {
  3.595994143616128*^9, 3.59599415161377*^9}, {3.595994256192569*^9, 
  3.595994265773363*^9}, {3.595994322920109*^9, 3.59599432313211*^9}, {
  3.595995495689452*^9, 3.5959954966214647`*^9}, {3.596568086940192*^9, 
  3.596568105097303*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Triangulation of the surface", "Section",
 CellChangeTimes->{{3.596365074595973*^9, 3.5963650876541224`*^9}}],

Cell[TextData[{
 "We want to compute a triangulation of the surface. This can be useful for \
drawing Costa\[CloseCurlyQuote]s surface with a program such as PovRay. The \
trouble is that we must avoid the singularities at the corners and the \
midpoints of the sides of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}], "\[Cross]", 
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ". "
}], "Text",
 CellChangeTimes->{{3.596425028416539*^9, 3.596425092119038*^9}, {
  3.596537072594993*^9, 3.596537114732897*^9}, {3.596537145355659*^9, 
  3.596537145360881*^9}, {3.5965681241306553`*^9, 3.596568139982185*^9}}],

Cell[CellGroupData[{

Cell["Generating the mesh", "Subsection",
 CellChangeTimes->{{3.5965374868092213`*^9, 3.5965374927524767`*^9}, {
  3.5965377051207123`*^9, 3.5965377077569237`*^9}}],

Cell[TextData[{
 "First we generate a mesh of the area which we will use for the \
parametrization of the surface. We excise from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}], "\[Cross]", 
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " small circles with radius ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "1"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " at the corners and small circles with radius ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " at midpoints of sides. We call these ",
 StyleBox["holes",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.5965681489412327`*^9, 3.596568198223654*^9}, {
  3.596568249466011*^9, 3.5965683258640547`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"outsideCircle", ",", "outsideHoles"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outsideCircle", "::", "usage"}], "=", 
   "\"\<Is p outside the circle centered at c with radius r?\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"outsideCircle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}], "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "c"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"p", "-", "c"}], ")"}]}], ">", 
    SuperscriptBox["r", "2"]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outsideHoles", "::", "usage"}], 
   "\"\<Is p outside the holes?\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outsideHoles", "[", 
    RowBox[{"r1_", ",", "r2_"}], "]"}], "[", 
   RowBox[{"p", ":", 
    RowBox[{"{", 
     RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"outsideCircle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], ",", "r1"}], "]"}], "[", "p", 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "&&", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outsideCircle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0"}], "}"}], ",", "r2"}], "]"}], "[", "p", "]"}], 
   " ", "&&", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outsideCircle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1"}], "}"}], ",", "r2"}], "]"}], "[", "p", "]"}], 
   " ", "&&", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outsideCircle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0.5"}], "}"}], ",", "r2"}], "]"}], "[", "p", "]"}], 
   " ", "&&", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outsideCircle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0.5"}], "}"}], ",", "r2"}], "]"}], "[", "p", "]"}], 
   " "}]}]}], "Input",
 CellChangeTimes->{{3.596542795322247*^9, 3.596543073342248*^9}, {
  3.596543122703184*^9, 3.5965431264737873`*^9}, {3.596546630904357*^9, 
  3.596546633571672*^9}, {3.596568207365571*^9, 3.596568242262025*^9}, {
  3.59656832864886*^9, 3.5965683427339373`*^9}}],

Cell["\<\
Next we write functions that triangulate the unit square without the points.\
\>", "Text",
 CellChangeTimes->{{3.596568352063393*^9, 3.59656839058947*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rectGrid", ",", "arcPoints", ",", "edgePoints", ",", "costaGrid"}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rectGrid", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "n"}], ",", 
            RowBox[{"j", "/", "n"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
     
     RowBox[{"outsideHoles", "[", 
      RowBox[{"r1", ",", "r2"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arcPoints", "[", 
    RowBox[{
    "x_", ",", "y_", ",", "r_", ",", "alpha_", ",", "beta_", ",", "n_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "+", 
        RowBox[{"r", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "*", 
              RowBox[{"(", 
               RowBox[{"n", "-", "i"}], ")"}]}], "+", 
             RowBox[{"beta", "*", "i"}]}], ")"}], "/", "n"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"y", "+", 
        RowBox[{"r", "*", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "*", 
              RowBox[{"(", 
               RowBox[{"n", "-", "i"}], ")"}]}], "+", 
             RowBox[{"beta", "*", "i"}]}], ")"}], "/", "n"}], "]"}]}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgePoints", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "n_", ",", "m_", ",", "l_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"seg", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r1", "*", 
               RowBox[{"(", 
                RowBox[{"n", "-", "i"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.5", "-", "r2"}], ")"}], "*", "i"}]}], ")"}], "/", 
            "n"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.5", "+", "r2"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"n", "-", "i"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "r1"}], ")"}], "*", "i"}]}], ")"}], "/", 
            "n"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", "seg", ",", 
           RowBox[{"{", "0", "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", "seg", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", 
           RowBox[{"{", "0", "}"}], ",", "seg"}], "]"}], ",", "1"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", 
           RowBox[{"{", "1", "}"}], ",", "seg"}], "]"}], ",", "1"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"0", ",", "0", ",", "r1", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}], ",", "m"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"1", ",", "0", ",", "r1", ",", 
         RowBox[{"Pi", "/", "2"}], ",", "Pi", ",", "m"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"1", ",", "1", ",", "r1", ",", "Pi", ",", 
         RowBox[{"3", 
          RowBox[{"Pi", "/", "2"}]}], ",", "m"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"0", ",", "1", ",", "r1", ",", 
         RowBox[{"3", 
          RowBox[{"Pi", "/", "2"}]}], ",", 
         RowBox[{"2", "Pi"}], ",", "m"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"0.5", ",", "0", ",", "r2", ",", "0", ",", "Pi", ",", "l"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"0.5", ",", "1", ",", "r2", ",", "Pi", ",", 
         RowBox[{"2", "Pi"}], ",", "l"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"0", ",", "0.5", ",", "r2", ",", 
         RowBox[{"3", 
          RowBox[{"Pi", "/", "2"}]}], ",", 
         RowBox[{"5", 
          RowBox[{"Pi", "/", "2"}]}], ",", "l"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arcPoints", "[", 
        RowBox[{"1", ",", "0.5", ",", "r2", ",", 
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"3", 
          RowBox[{"Pi", "/", "2"}]}], ",", "l"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"costaGrid", "::", "usage"}], " ", "=", " ", 
   "\"\<costaGrid[r1,r2,k,n,m,l] generates a point grid suitable for \
triangulation, where r1 and r2 are the radii of the holes, and k, n, m, l \
determine the density of the grid inside the area, on the straight edges, on \
the corner holes and the side holes, respectively.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaGrid", "[", 
   RowBox[{"r1_", ",", "r2_", ",", "k_", ",", "n_", ",", "m_", ",", "l_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"N", "@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"rectGrid", "[", 
      RowBox[{
       RowBox[{"1.1", "*", "r1"}], ",", 
       RowBox[{"1.1", "*", "r2"}], ",", "k"}], "]"}], ",", 
     RowBox[{"edgePoints", "[", 
      RowBox[{"r1", ",", "r2", ",", "n", ",", "m", ",", "l"}], "]"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.596542745771942*^9, 3.596542779546254*^9}, {
   3.596543079766658*^9, 3.596543091232504*^9}, {3.5965431711820707`*^9, 
   3.5965432443123713`*^9}, 3.5965440956801023`*^9, {3.5965441771379833`*^9, 
   3.596544468083712*^9}, {3.5965458110608387`*^9, 3.59654617420875*^9}, {
   3.596546219761524*^9, 3.5965463002077417`*^9}, {3.5965463322874413`*^9, 
   3.5965463369269876`*^9}, {3.596546374507297*^9, 3.596546379596106*^9}, {
   3.596546414245867*^9, 3.596546422490328*^9}, {3.596546457976565*^9, 
   3.596546497456937*^9}, {3.596546570678542*^9, 3.596546583910087*^9}, {
   3.5965466440807056`*^9, 3.596546663385847*^9}, {3.596546904412211*^9, 
   3.5965469067456284`*^9}, {3.59654695565856*^9, 3.596546956832295*^9}, {
   3.596546988953937*^9, 3.596546989296092*^9}, {3.596568379604211*^9, 
   3.596568539188714*^9}, {3.596568618440366*^9, 3.596568620282589*^9}}],

Cell["\<\
A picture of the grid will explain what we are going for:\
\>", "Text",
 CellChangeTimes->{{3.596568551280961*^9, 3.596568565316517*^9}}],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"Point", "/@", 
   RowBox[{"costaGrid", "[", 
    RowBox[{"0.2", ",", "0.15", ",", "20", ",", "4", ",", "10", ",", "15"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.596568567729863*^9, 3.596568627376412*^9}}],

Cell[TextData[{
 "We need to triangulate the mesh. The ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " function ",
 StyleBox["ListDensityPlot", "Input"],
 " computed the Delaunay triangulation in a much more useful way than ",
 StyleBox["DelaunayTriangulation", "Input"],
 ", so this is what we use:"
}], "Text",
 CellChangeTimes->{{3.596568631997363*^9, 3.596568726386036*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "triangles", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"triangles", "::", "usage"}], "=", 
   "\"\<Triangulate the given set of points.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"triangles", "[", "points_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"First", "@", 
   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"ArrayPad", "[", 
       RowBox[{"points", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Polygon", "[", "a_", "]"}], "\[RuleDelayed]", "a"}], ",", 
     "\[IndentingNewLine]", "Infinity"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.596565710892202*^9, 3.5965657700099583`*^9}, {
  3.596565993954268*^9, 3.5965660008113403`*^9}, {3.596568731558982*^9, 
  3.596568746623595*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "barycenter", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barycenter", "::", "usage"}], "=", 
   "\"\<Compute the barycenter of the triangle whose vertices are given by \
i,j,k.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barycenter", "[", 
   RowBox[{"pts_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"pts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "+", 
     RowBox[{"pts", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
     "+", 
     RowBox[{"pts", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
    ")"}], "/", "3"}]}]}], "Input",
 CellChangeTimes->{{3.596566001934024*^9, 3.5965660462013817`*^9}, {
  3.596566158919077*^9, 3.5965661665815153`*^9}, {3.596568750772895*^9, 
  3.596568780890967*^9}}],

Cell[TextData[{
 "The function ",
 StyleBox["triangles", "Input"],
 " triangulates the convex hull of the given points. To get the desired \
triangulation, we filter out those triangles whose barycenters are inside the \
holes:"
}], "Text",
 CellChangeTimes->{{3.596568813881686*^9, 3.596568859972372*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "costaTriangulate", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"costaTriangulate", "::", "usage"}], "=", 
   "\"\<Return the points and the triangles of a mesh for drawing Costa's \
surface.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaTriangulate", "[", 
   RowBox[{"r1_", ",", "r2_", ",", "k_", ",", "m_", ",", "n_", ",", "l_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pts", "=", 
      RowBox[{"costaGrid", "[", 
       RowBox[{"r1", ",", "r2", ",", "k", ",", "m", ",", "n", ",", "l"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"pts", ",", "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"triangles", "[", "pts", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"outsideHoles", "[", 
           RowBox[{"r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"barycenter", "[", 
           RowBox[{"pts", ",", "#"}], "]"}], "]"}], "&"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.596565957966279*^9, 3.596565990085629*^9}, {
  3.5965660556532*^9, 3.5965661521626463`*^9}, {3.596566220532528*^9, 
  3.596566222989018*^9}, {3.59656887342239*^9, 3.5965688988924217`*^9}}],

Cell["\<\
A picture of the triangulation (the holes are made bigger than necessary):\
\>", "Text",
 CellChangeTimes->{{3.596568906999735*^9, 3.59656891234781*^9}, {
  3.596569092956464*^9, 3.596569106990687*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"grid", ",", "trs"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"grid", ",", "trs"}], "}"}], "=", 
   RowBox[{"costaTriangulate", "[", 
    RowBox[{
     RowBox[{"1", "/", "6"}], ",", 
     RowBox[{"1", "/", "8"}], ",", "20", ",", "8", ",", "16", ",", "16"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
    RowBox[{"GraphicsComplex", "[", 
     RowBox[{
      RowBox[{"N", "[", "grid", "]"}], ",", 
      RowBox[{"Polygon", "/@", "trs"}]}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.59656891884354*^9, 3.596568967713291*^9}, {
  3.596569108860807*^9, 3.596569111905088*^9}}],

Cell["\<\
We can also draw the surface with small triangles, together with the normals \
at the vertices:\
\>", "Text",
 CellChangeTimes->{{3.596568981106202*^9, 3.5965690003552237`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"grid", ",", "trs", ",", "costaA", ",", "costaT"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"grid", ",", "trs"}], "}"}], "=", 
   RowBox[{"costaTriangulate", "[", 
    RowBox[{
     RowBox[{"1", "/", "10"}], ",", 
     RowBox[{"1", "/", "30"}], ",", "10", ",", "5", ",", "10", ",", "10"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"costaA", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"normalArrow", "@@@", "grid"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaT", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
      RowBox[{"FaceForm", "[", "White", "]"}], ",", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"costa", " ", "@@@", "grid"}], "]"}], ",", 
        RowBox[{"Polygon", "/@", "trs"}]}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"costaA", ",", "costaT"}], "]"}]}], "Input",
 CellChangeTimes->{{3.596542734424494*^9, 3.596542736715604*^9}, {
  3.5965468203970957`*^9, 3.596546829710833*^9}, {3.596565781261181*^9, 
  3.596565794801833*^9}, {3.5965661756075172`*^9, 3.596566198010949*^9}, {
  3.5965662368993673`*^9, 3.5965664107600403`*^9}, {3.596566548706162*^9, 
  3.596566570877599*^9}, {3.596566690672492*^9, 3.59656680001847*^9}, {
  3.596566984094892*^9, 3.596567052840458*^9}, {3.596567275643729*^9, 
  3.596567286240019*^9}, {3.596569003803795*^9, 3.596569037797883*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving the data", "Subsection",
 CellChangeTimes->{{3.596569163845488*^9, 3.596569165465599*^9}}],

Cell["\<\
A utility function for saving the data into a CSV file, suitable for further \
processing.\
\>", "Text",
 CellChangeTimes->{{3.5965691672791643`*^9, 3.596569207610861*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "costaCSV", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"costaCSV", "::", "usage"}], "=", 
   "\"\<Save Costa's surface data to the given CSV file\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costaCSV", "[", 
   RowBox[{
   "file_", ",", "r1_", ",", "r2_", ",", "k_", ",", "m_", ",", "n_", ",", 
    "l_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"grid", ",", "trs", ",", "data"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"grid", ",", "trs"}], "}"}], "=", 
      RowBox[{"costaTriangulate", "[", 
       RowBox[{"r1", ",", "r2", ",", "k", ",", "m", ",", "n", ",", "l"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"r1", ",", "r2", ",", "k", ",", "m", ",", "n", ",", "l"}], 
           "}"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "grid", "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"N", "[", 
         RowBox[{"costa", "@@@", "grid"}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{"Length", "[", "grid", "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"N", "[", 
         RowBox[{"costaNormal", "@@@", "grid"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "trs", "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"trs", "-", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "data"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.596569203093049*^9, 3.596569415524106*^9}, {
  3.596569518731536*^9, 3.596569525231785*^9}, {3.5965695584129887`*^9, 
  3.5965695703405857`*^9}, {3.5965696185027657`*^9, 3.596569779674518*^9}, {
  3.59657006556606*^9, 3.5965700708639927`*^9}, {3.596570514814331*^9, 
  3.596570562370655*^9}, {3.596570766508972*^9, 3.5965707701612587`*^9}}],

Cell[BoxData[
 RowBox[{"costaCSV", "[", 
  RowBox[{"\"\<costa.csv\>\"", ",", 
   RowBox[{"1", "/", "10"}], ",", 
   RowBox[{"1", "/", "30"}], ",", "40", ",", "20", ",", "40", ",", "40"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.596569303831319*^9, 3.5965693160342216`*^9}, {
  3.596569430609724*^9, 3.596569444574592*^9}, {3.596572853582301*^9, 
  3.5965728614898357`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1314, 812},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
ShowSelection->True,
Magnification:>1.5 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 149, 3, 134, "Title"],
Cell[731, 27, 98, 1, 46, "Subtitle"],
Cell[832, 30, 233, 5, 43, "Subsubtitle"],
Cell[CellGroupData[{
Cell[1090, 39, 167, 2, 122, "Section"],
Cell[1260, 43, 1938, 58, 109, "Text"],
Cell[3201, 103, 544, 17, 47, "Text"],
Cell[3748, 122, 4171, 113, 508, "Input"],
Cell[7922, 237, 142, 1, 46, "Text"],
Cell[8067, 240, 769, 15, 57, "Input"],
Cell[8839, 257, 182, 5, 46, "Text"],
Cell[9024, 264, 423, 11, 57, "Input"],
Cell[9450, 277, 466, 7, 76, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9953, 289, 129, 3, 122, "Section"],
Cell[10085, 294, 1581, 50, 141, "Text"],
Cell[11669, 346, 653, 13, 105, "Text"],
Cell[12325, 361, 1230, 32, 133, "Input"],
Cell[13558, 395, 883, 29, 84, "Text"],
Cell[14444, 426, 888, 25, 120, "Input"],
Cell[15335, 453, 780, 26, 81, "Text"],
Cell[16118, 481, 960, 27, 108, "Input"],
Cell[17081, 510, 277, 9, 47, "Text"],
Cell[17361, 521, 3500, 90, 408, "Input"],
Cell[20864, 613, 200, 4, 46, "Text"],
Cell[21067, 619, 501, 11, 57, "Input"],
Cell[21571, 632, 96, 1, 46, "Text"],
Cell[21670, 635, 326, 10, 48, "Text"],
Cell[21999, 647, 3658, 92, 408, "Input"],
Cell[25660, 741, 127, 3, 46, "Text"],
Cell[25790, 746, 503, 11, 57, "Input"],
Cell[26296, 759, 143, 3, 46, "Text"],
Cell[26442, 764, 736, 19, 108, "Input"],
Cell[27181, 785, 153, 3, 46, "Text"],
Cell[27337, 790, 1002, 24, 133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28376, 819, 115, 1, 122, "Section"],
Cell[28494, 822, 719, 17, 77, "Text"],
Cell[CellGroupData[{
Cell[29238, 843, 164, 2, 47, "Subsection"],
Cell[29405, 847, 865, 27, 78, "Text"],
Cell[30273, 876, 2613, 77, 310, "Input"],
Cell[32889, 955, 165, 3, 46, "Text"],
Cell[33057, 960, 8159, 208, 983, "Input"],
Cell[41219, 1170, 147, 3, 46, "Text"],
Cell[41369, 1175, 270, 6, 57, "Input"],
Cell[41642, 1183, 385, 10, 76, "Text"],
Cell[42030, 1195, 1073, 27, 208, "Input"],
Cell[43106, 1224, 926, 23, 133, "Input"],
Cell[44035, 1249, 306, 7, 76, "Text"],
Cell[44344, 1258, 1388, 33, 258, "Input"],
Cell[45735, 1293, 212, 4, 46, "Text"],
Cell[45950, 1299, 838, 22, 108, "Input"],
Cell[46791, 1323, 187, 4, 46, "Text"],
Cell[46981, 1329, 1601, 39, 208, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48619, 1373, 103, 1, 47, "Subsection"],
Cell[48725, 1376, 182, 4, 46, "Text"],
Cell[48910, 1382, 2300, 56, 433, "Input"],
Cell[51213, 1440, 375, 8, 57, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
